generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model AccountCategory {
  id        String    @id @default(cuid())
  name      String    @unique
  type      String    @default("ASSET")
  isDefault Boolean   @default(false)
  createdAt DateTime  @default(now())
  accounts  Account[]
}

model Account {
  id         String             @id @default(cuid())
  name       String
  type       String
  categoryId String
  isActive   Boolean            @default(true)
  createdAt  DateTime           @default(now())
  category   AccountCategory    @relation(fields: [categoryId], references: [id])
  snapshots  NetWorthSnapshot[]
}

model NetWorthSnapshot {
  id        String   @id @default(cuid())
  accountId String
  value     Decimal
  month     Int
  year      Int
  createdAt DateTime @default(now())
  account   Account  @relation(fields: [accountId], references: [id])

  @@unique([accountId, month, year])
}

model BudgetCategory {
  id        String        @id @default(cuid())
  name      String        @unique
  isActive  Boolean       @default(true)
  sortOrder Int           @default(0)
  createdAt DateTime      @default(now())
  entries   BudgetEntry[]
}

model BudgetEntry {
  id         String         @id @default(cuid())
  categoryId String
  month      Int
  year       Int
  budgeted   Decimal
  spent      Decimal        @default(0)
  createdAt  DateTime       @default(now())
  category   BudgetCategory @relation(fields: [categoryId], references: [id])

  @@unique([categoryId, month, year])
}

model MonthlyIncome {
  id        String   @id @default(cuid())
  month     Int
  year      Int
  amount    Decimal
  note      String?
  createdAt DateTime @default(now())

  @@unique([month, year])
}
